{
    "$schema": "../../board-game-engine/schema/json-schema/game-definition.schema.json",
    "actions": [
        {
            "description": "Place a token on a hexagonal cell",
            "displayName": "Place Token",
            "effects": [
                {
                    "components": {
                        "GridLocation": {
                            "column": null,
                            "grid": null,
                            "q": "$component.$target.0.GridLocation.q",
                            "r": "$component.$target.0.GridLocation.r",
                            "row": null
                        },
                        "Token": {
                            "color": "$param.tokenColor",
                            "playerIndex": "$param.playerIndex"
                        }
                    },
                    "storeAs": "newToken",
                    "type": "createEntity",
                    "zone": "board"
                },
                {
                    "condition": {
                        "component": "Player",
                        "entity": "$actor",
                        "property": "playerNumber",
                        "type": "componentValueCheck",
                        "value": 2
                    },
                    "then": [
                        {
                            "component": "Token",
                            "entity": "$newToken",
                            "type": "setComponentValue",
                            "values": {
                                "color": "blue",
                                "playerIndex": 1
                            }
                        }
                    ],
                    "type": "conditional"
                },
                {
                    "type": "switchActivePlayer"
                }
            ],
            "id": "PlaceToken",
            "name": "PlaceToken",
            "preconditions": [
                {
                    "type": "isPlayerTurn"
                },
                {
                    "component": "GridLocation",
                    "entity": "$target.0",
                    "errorMessage": "Target must be a hexagonal cell",
                    "operator": "!=",
                    "property": "q",
                    "type": "componentValueCheck",
                    "value": null
                }
            ],
            "targetCount": 1,
            "targeting": {
                "count": 1,
                "validTargets": {
                    "hasComponent": ["GridLocation"],
                    "owner": "any",
                    "zone": "board"
                }
            }
        }
    ],

    "components": {
        "GridLocation": {
            "properties": {
                "column": { "default": null, "type": "number" },
                "grid": { "default": null, "type": "entity" },
                "q": { "default": null, "type": "number" },
                "r": { "default": null, "type": "number" },
                "row": { "default": null, "type": "number" }
            }
        },
        "Token": {
            "properties": {
                "color": { "default": "red", "type": "string" },
                "playerIndex": { "default": 0, "type": "number" }
            }
        }
    },

    "entityTemplates": {
        "HexCell": {
            "components": {
                "GridLocation": {
                    "column": null,
                    "grid": null,
                    "q": 0,
                    "r": 0,
                    "row": null
                }
            }
        },
        "Player": {
            "components": {}
        }
    },

    "metadata": {
        "author": "ue-too",
        "complexity": "simple",
        "description": "Example game demonstrating hexagonal grid positioning",
        "maxPlayers": 2,
        "minPlayers": 2,
        "tags": ["hexagonal", "grid", "example"]
    },

    "name": "Hex Grid Example",
    "phases": [
        {
            "allowedActions": ["PlaceToken"],
            "autoAdvance": false,
            "name": "Play"
        }
    ],

    "rules": [],

    "setup": {
        "initialPhase": "Play",
        "perPlayer": {
            "template": "Player",
            "zones": []
        },
        "playerCount": { "max": 2, "min": 2 },
        "sharedZoneEntities": [
            {
                "count": 19,
                "template": "HexCell",
                "zone": "board"
            }
        ]
    },

    "version": "1.0.0",
    "winConditions": [],
    "zones": {
        "board": {
            "maxCapacity": 50,
            "ordered": false,
            "shared": true,
            "visibility": "public"
        }
    }
}
