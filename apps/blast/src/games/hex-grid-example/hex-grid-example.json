{
  "$schema": "../../board-game-engine/schema/json-schema/game-definition.schema.json",
  "name": "Hex Grid Example",
  "version": "1.0.0",
  "metadata": {
    "author": "ue-too",
    "description": "Example game demonstrating hexagonal grid positioning",
    "minPlayers": 2,
    "maxPlayers": 2,
    "complexity": "simple",
    "tags": ["hexagonal", "grid", "example"]
  },

  "components": {
    "Token": {
      "properties": {
        "color": { "type": "string", "default": "red" },
        "playerIndex": { "type": "number", "default": 0 }
      }
    },
    "GridLocation": {
      "properties": {
        "grid": { "type": "entity", "default": null },
        "row": { "type": "number", "default": null },
        "column": { "type": "number", "default": null },
        "q": { "type": "number", "default": null },
        "r": { "type": "number", "default": null }
      }
    }
  },

  "zones": {
    "board": {
      "visibility": "public",
      "ordered": false,
      "shared": true,
      "maxCapacity": 50
    }
  },

  "entityTemplates": {
    "HexCell": {
      "components": {
        "GridLocation": {
          "grid": null,
          "row": null,
          "column": null,
          "q": 0,
          "r": 0
        }
      }
    },
    "Player": {
      "components": {}
    }
  },

  "actions": [
    {
      "id": "PlaceToken",
      "name": "PlaceToken",
      "displayName": "Place Token",
      "description": "Place a token on a hexagonal cell",
      "targetCount": 1,
      "targeting": {
        "count": 1,
        "validTargets": {
          "zone": "board",
          "owner": "any",
          "hasComponent": ["GridLocation"]
        }
      },
      "preconditions": [
        {
          "type": "isPlayerTurn"
        },
        {
          "type": "componentValueCheck",
          "entity": "$target.0",
          "component": "GridLocation",
          "property": "q",
          "value": null,
          "operator": "!=",
          "errorMessage": "Target must be a hexagonal cell"
        }
      ],
      "effects": [
        {
          "type": "createEntity",
          "components": {
            "Token": {
              "color": "$param.tokenColor",
              "playerIndex": "$param.playerIndex"
            },
            "GridLocation": {
              "grid": null,
              "row": null,
              "column": null,
              "q": "$component.$target.0.GridLocation.q",
              "r": "$component.$target.0.GridLocation.r"
            }
          },
          "zone": "board",
          "storeAs": "newToken"
        },
        {
          "type": "conditional",
          "condition": {
            "type": "componentValueCheck",
            "entity": "$actor",
            "component": "Player",
            "property": "playerNumber",
            "value": 2
          },
          "then": [
            {
              "type": "setComponentValue",
              "entity": "$newToken",
              "component": "Token",
              "values": {
                "color": "blue",
                "playerIndex": 1
              }
            }
          ]
        },
        {
          "type": "switchActivePlayer"
        }
      ]
    }
  ],

  "phases": [
    {
      "name": "Play",
      "allowedActions": ["PlaceToken"],
      "autoAdvance": false
    }
  ],

  "rules": [],

  "setup": {
    "playerCount": { "min": 2, "max": 2 },
    "initialPhase": "Play",
    "perPlayer": {
      "template": "Player",
      "zones": []
    },
    "sharedZoneEntities": [
      {
        "template": "HexCell",
        "zone": "board",
        "count": 19
      }
    ]
  },

  "winConditions": []
}
