{
    "$id": "https://ue-too.dev/schemas/component-schema.schema.json",
    "$schema": "http://json-schema.org/draft-07/schema#",
    "definitions": {
        "arrayElementType": {
            "oneOf": [
                {
                    "$ref": "#/definitions/builtinArrayElementType"
                },
                {
                    "$ref": "#/definitions/customArrayElementType"
                }
            ]
        },
        "arrayField": {
            "additionalProperties": false,
            "properties": {
                "arrayElementType": {
                    "$ref": "#/definitions/arrayElementType"
                },
                "defaultValue": {
                    "description": "Default value for the array field (should be an array)",
                    "items": {},
                    "type": "array"
                },
                "name": {
                    "description": "The name of the field",
                    "pattern": "^[a-zA-Z_][a-zA-Z0-9_]*$",
                    "type": "string"
                },
                "optional": {
                    "default": false,
                    "description": "Whether the field is optional (default: false)",
                    "type": "boolean"
                },
                "type": {
                    "description": "Must be 'array' for array fields",
                    "enum": ["array"],
                    "type": "string"
                }
            },
            "required": ["name", "type", "arrayElementType"],
            "type": "object"
        },
        "builtinArrayElementType": {
            "additionalProperties": false,
            "properties": {
                "kind": {
                    "description": "Indicates this is a built-in type",
                    "enum": ["builtin"],
                    "type": "string"
                },
                "type": {
                    "description": "The built-in type for array elements",
                    "enum": ["string", "number", "boolean", "object", "entity"],
                    "type": "string"
                }
            },
            "required": ["kind", "type"],
            "type": "object"
        },
        "componentField": {
            "oneOf": [
                {
                    "$ref": "#/definitions/primitiveField"
                },
                {
                    "$ref": "#/definitions/arrayField"
                }
            ]
        },
        "customArrayElementType": {
            "additionalProperties": false,
            "properties": {
                "kind": {
                    "description": "Indicates this is a custom component type",
                    "enum": ["custom"],
                    "type": "string"
                },
                "typeName": {
                    "description": "The name of the custom component type (must be a valid identifier for Symbol.for)",
                    "pattern": "^[a-zA-Z_][a-zA-Z0-9_]*$",
                    "type": "string"
                }
            },
            "required": ["kind", "typeName"],
            "type": "object"
        },
        "primitiveField": {
            "additionalProperties": false,
            "properties": {
                "defaultValue": {
                    "description": "Default value for the field (type should match the field type)",
                    "oneOf": [
                        { "type": "string" },
                        { "type": "number" },
                        { "type": "boolean" },
                        { "type": "object" },
                        { "type": "null" }
                    ]
                },
                "name": {
                    "description": "The name of the field",
                    "pattern": "^[a-zA-Z_][a-zA-Z0-9_]*$",
                    "type": "string"
                },
                "optional": {
                    "default": false,
                    "description": "Whether the field is optional (default: false)",
                    "type": "boolean"
                },
                "type": {
                    "description": "The type of the field (primitive types, excluding 'array')",
                    "enum": ["string", "number", "boolean", "object", "entity"],
                    "type": "string"
                }
            },
            "required": ["name", "type"],
            "type": "object"
        }
    },
    "description": "JSON schema for validating component schema definitions used in the ECS system",
    "examples": [
        {
            "componentName": "PlayerStatsComponent",
            "fields": [
                {
                    "defaultValue": 100,
                    "name": "health",
                    "type": "number"
                },
                {
                    "defaultValue": 100,
                    "name": "maxHealth",
                    "type": "number"
                },
                {
                    "defaultValue": 50,
                    "name": "mana",
                    "type": "number"
                },
                {
                    "defaultValue": 1,
                    "name": "level",
                    "type": "number"
                },
                {
                    "defaultValue": 0,
                    "name": "experience",
                    "type": "number"
                }
            ]
        },
        {
            "componentName": "InventoryComponent",
            "fields": [
                {
                    "arrayElementType": {
                        "kind": "builtin",
                        "type": "string"
                    },
                    "defaultValue": [],
                    "name": "items",
                    "type": "array"
                },
                {
                    "arrayElementType": {
                        "kind": "custom",
                        "typeName": "ItemComponent"
                    },
                    "defaultValue": [],
                    "name": "equipment",
                    "type": "array"
                },
                {
                    "defaultValue": 20,
                    "name": "maxSlots",
                    "optional": false,
                    "type": "number"
                }
            ]
        }
    ],
    "properties": {
        "componentName": {
            "description": "The name of the component type (must be a valid identifier for Symbol.for)",
            "examples": [
                "PlayerStatsComponent",
                "HealthComponent",
                "LocationComponent"
            ],
            "pattern": "^[a-zA-Z_][a-zA-Z0-9_]*$",
            "type": "string"
        },
        "fields": {
            "description": "Array of field definitions for the component",
            "items": {
                "$ref": "#/definitions/componentField"
            },
            "minItems": 0,
            "type": "array"
        }
    },
    "required": ["componentName", "fields"],
    "title": "Component Schema",
    "type": "object"
}
